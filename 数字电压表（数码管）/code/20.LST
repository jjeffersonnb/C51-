C51 COMPILER V9.00   20                                                                    12/08/2016 17:00:47 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE 20
OBJECT MODULE PLACED IN 20.OBJ
COMPILER INVOKED BY: C:\APPS\Keil\C51\BIN\C51.EXE 20.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /***************   数字电压表   ******************/
   2          #include <reg52.h>
   3          #define uint unsigned int
   4          #define uchar unsigned char
   5          
   6          uchar code LEDData[]=
   7          {
   8                  0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f
   9          };
  10          sbit OE  = P1^0;
  11          sbit EOC = P1^1;
  12          sbit ST  = P1^2;
  13          sbit CLK = P1^3;
  14          sbit DP  = P0^7;
  15          
  16          void DelayMS(uint ms)
  17          {
  18   1              uchar i;
  19   1              while(ms--)
  20   1              {
  21   2                      for(i=0;i<120;i++);
  22   2              }
  23   1      }
  24          
  25          void Display_Result(uchar d)
  26          {
  27   1              uint u = d*100/51; //将0-255级换算成0.00-5.00的电压数值
  28   1              uchar dis[3];
  29   1              dis[0]=u/100;
  30   1              dis[1]=u/10%10;
  31   1              dis[2]=u%10;
  32   1      
  33   1              P2 = 0xf7; //右边第一位
  34   1              P0 = LEDData[dis[2]];
  35   1              DelayMS(3);
  36   1              P2 = 0xfb; //第二位
  37   1              P0 = LEDData[dis[1]];
  38   1              DelayMS(3);
  39   1              P2 = 0xfd; //第三位
  40   1              P0 = LEDData[dis[0]] ;
  41   1              DP = 1;    //小数点显示
  42   1              DelayMS(2);
  43   1      }
  44          
  45          void main()
  46          {
  47   1              TMOD = 0x02;
  48   1              TH0  = 256-1;
  49   1              TL0  = 256-1; //定时5us，ADC0809时钟为100KHz
  50   1      
  51   1              IE   = 0x82;
  52   1              TR0  = 1;
  53   1              P1   = 0x3f;
  54   1              while(1)
  55   1              {
C51 COMPILER V9.00   20                                                                    12/08/2016 17:00:47 PAGE 2   

  56   2                      ST = 0;
  57   2                      ST = 1;
  58   2                      ST = 0;
  59   2                      while(EOC == 0);
  60   2                      OE = 1;
  61   2                      Display_Result(P3);
  62   2                      OE = 0;
  63   2              }
  64   1      }
  65          
  66          void Timer0_INT() interrupt 1
  67          {
  68   1              CLK = !CLK;
  69   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    166    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
