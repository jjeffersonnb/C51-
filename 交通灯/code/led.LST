C51 COMPILER V9.00   LED                                                                   10/20/2014 15:58:17 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN led.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE led.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          //LED模拟交通灯
   2          //说明：东西向绿灯亮若干秒后，黄灯闪烁5次后红灯亮，
   3          //红灯亮后，南北向由红灯变为绿灯，绿灯亮若干秒后南北向黄灯闪烁，
   4          //闪烁5次后亮红灯，东西向绿灯亮，如此重复。
   5          #include <reg52.h>
   6          #define uchar unsigned char
   7          #define uint unsigned int
   8          
   9          sbit RED_A=P0^0;   //东西向指示灯
  10          sbit YELLOW_A=P0^1;
  11          sbit GREEN_A=P0^2;
  12          sbit RED_B=P0^3;   //南北向指示灯
  13          sbit YELLOW_B=P0^4;
  14          sbit GREEN_B=P0^5;
  15          
  16          uchar Flash_Count = 0;  //闪烁次数
  17          uchar Operation_Type = 1;               //操作类型变量
  18          
  19          void DelayMS(uint x)    //延时函数
  20          {
  21   1              uchar t;
  22   1              while(x--)
  23   1              {
  24   2                      for(t=120;t>0;t--);
  25   2              }
  26   1      }
  27          
  28          void Traffic_lignt()  //交通灯切换子程序
  29          {
  30   1              switch(Operation_Type)
  31   1              {
  32   2                      case 1: //东西向绿灯与南北向红灯亮
  33   2                              RED_A=1;YELLOW_A=1;GREEN_A=0;
  34   2                              RED_B=0;YELLOW_B=1;GREEN_B=1;
  35   2                              DelayMS(2000);
  36   2                              Operation_Type = 2; //下一操作
  37   2                              break;
  38   2                      case 2:  //东西向黄灯开始闪烁，绿灯关闭
  39   2                              DelayMS(200);
  40   2                              YELLOW_A=~YELLOW_A;
  41   2                              if(++Flash_Count !=10) 
  42   2                                      return;
  43   2                              Flash_Count=0;
  44   2                              Operation_Type = 3;     //下一操作
  45   2                              break;
  46   2                      case 3:   //东西向红灯与南北向绿灯亮
  47   2                              RED_A=0;YELLOW_A=1;GREEN_A=1;
  48   2                              RED_B=1;YELLOW_B=1;GREEN_B=0;
  49   2                              DelayMS(2000);
  50   2                              Operation_Type = 4;      //下一操作
  51   2                              break;  
  52   2                      case 4:    //南北向黄灯开始闪烁
  53   2                              DelayMS(200);
  54   2                              YELLOW_B=~YELLOW_B;
  55   2                              if(++Flash_Count !=10) 
C51 COMPILER V9.00   LED                                                                   10/20/2014 15:58:17 PAGE 2   

  56   2                                      return;
  57   2                              Flash_Count=0;
  58   2                              Operation_Type = 1;     //回到第一种操作
  59   2                              break;  
  60   2              }
  61   1      }
  62          
  63          void main()
  64          {
  65   1              while(1)
  66   1              {
  67   2                      Traffic_lignt();        
  68   2              }
  69   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    136    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
